import{O as R,P as W,o as B,e as N,g as x,r as A,b as D,w as j,D as H,d as O,v as U,x as X,z as T}from"./modules/vue-DtEGhQT5.js";import{u as L,f as $}from"./slidev/context-CoHpShTk.js";import{p as a}from"./app-Ddl2Q9KC.js";import"./p5.tree.esm-BaqJxL2q.js";import{I as G}from"./slidev/default-UkZ1xmVw.js";import"./index-BAg_tTDD.js";import"./modules/shiki--QlaK0aY.js";import"./modules/file-saver-Ds2qT4Ee.js";const Y={class:"relative inline-block rounded-lg shadow-2xl border border-white/10 overflow-hidden"},Z={__name:"VisibilitySketch",setup(M){L();const o=A(null);let f=null;const _=e=>{let d,I,k,y,g,r,m,u,v,w,c,s,h,l,V,E;const C=[-350,-279,181],P=[12.9,6.4,48.3],z=[-.53,.78,.23],F=()=>{if(e.camera(0,0,m.value(),0,0,m.value()>0?-300:300,0,1,0),V=e.eMatrix(),g.checked()){if(r.checked()){const t=v.value(),n=t*Math.tan(u.value()/2),S=-n,i=n*(e.width/e.height),b=-i;e.frustum(b,i,n,S,t,w.value())}else e.frustum(c.value(),s.value(),l.value(),h.value(),v.value(),w.value());r.checked()?u.show():u.hide(),r.checked()?c.hide():c.show(),r.checked()?s.hide():s.show(),r.checked()?l.hide():l.show(),r.checked()?h.hide():h.show()}else u.hide(),l.show(),r.checked()?(s.value(l.value()*(e.width/e.height)),e.ortho(-s.value(),s.value(),l.value(),-l.value(),v.value(),w.value())):e.ortho(c.value(),s.value(),l.value(),h.value(),v.value(),w.value()),r.checked()?s.hide():s.show(),r.checked()?c.hide():c.show(),r.checked()?h.hide():h.show();E=e.pMatrix()};e.setup=function(){e.createCanvas(580,360,e.WEBGL).parent(o.value),e.frameRate(100),e.colorMode(e.RGB,1),d=e.createFramebuffer({format:e.FLOAT});const n=100;I=[];for(let S=0;S<50;S++){const i={type:e.random()<.5?"box":"sphere",visibility:a.Tree.VISIBLE,color:e.color(e.random(),e.random(),e.random()),position:a.Vector.random3D().mult(n),velocity:e.createVector(e.random()*2-1,e.random()*2-1,e.random()*2-1).mult(.5),rotation:e.createVector(e.random(),e.random(),e.random()).normalize().mult(.01),animate(){this.position.add(this.velocity),["x","y","z"].forEach(b=>{e.abs(this.position[b])>n&&(this.velocity[b]*=-1,this.position[b]=e.constrain(this.position[b],-n,n))})}};i.type==="box"?(i.width=e.random()*12+8,i.height=e.random()*12+8,i.depth=e.random()*12+8,i.cull=()=>{i.visibility=e.visibility({corner1:a.Vector.sub(i.position,e.createVector(i.width/2,i.height/2,i.depth/2)),corner2:a.Vector.add(i.position,e.createVector(i.width/2,i.height/2,i.depth/2))})}):(i.radius=e.random()*12+8,i.cull=()=>{i.visibility=e.visibility({center:i.position,radius:i.radius})}),I.push(i)}k=e.createCheckbox("animate",!0),k.parent(o.value),k.style("color","indigo"),k.position(e.width-200,10),y=e.createCheckbox("cull",!0),y.parent(o.value),y.style("color","indigo"),y.position(e.width-200,35),g=e.createCheckbox("perspective",!0),g.parent(o.value),g.style("color","yellow"),g.position(e.width-110,10),r=e.createCheckbox("aspect ratio",!0),r.parent(o.value),r.style("color","yellow"),r.position(e.width-110,35),m=e.createSlider(-150,200,115,1),m.parent(o.value),m.style("width","100px"),m.position(e.width-110,60),u=e.createSlider(.1,1.4,.6,.01),u.parent(o.value),u.style("width","100px"),u.position(e.width-110,85),v=e.createSlider(20,100,30,1),v.parent(o.value),v.style("width","100px"),v.position(e.width-110,110),w=e.createSlider(110,330,230,1),w.parent(o.value),w.style("width","100px"),w.position(e.width-110,135),l=e.createSlider(10,e.height/3,e.height/12,1),l.parent(o.value),l.style("width","100px"),l.position(e.width-110,160),s=e.createSlider(10,e.width/3,e.width/12,1),s.parent(o.value),s.style("width","100px"),s.position(e.width-110,185),h=e.createSlider(-e.height/3,-10,-e.height/12,1),h.parent(o.value),h.style("width","100px"),h.position(e.width-110,210),c=e.createSlider(-e.width/3,-10,-e.width/12,1),c.parent(o.value),c.style("width","100px"),c.position(e.width-110,235),e.camera(...C,...P,...z),e.ortho(-e.width/3,e.width/3,-e.height/3,e.height/3,1,1e4)},e.draw=function(){(e.mouseX<=e.width-120||e.mouseY>=265)&&e.orbitControl(),e.background("#879319"),e.push(),e.rotateX(e.HALF_PI),e.strokeWeight(.5),e.stroke("blue"),e.grid({subdivisions:20,size:300}),e.pop(),I.forEach(t=>{e.push(),e.translate(t.position),e.strokeWeight(t.visibility===a.Tree.INVISIBLE?1:1.2),t.visibility===a.Tree.VISIBLE?(e.fill(t.color),e.noStroke()):(e.noFill(),e.strokeWeight(1),t.visibility===a.Tree.SEMIVISIBLE?e.stroke(t.color):e.stroke("black"));const n=t.visibility===a.Tree.VISIBLE?20:6;t.type==="box"?e.box(t.width,t.height,t.depth):e.sphere(t.radius,n,n),e.pop()}),e.push(),e.strokeWeight(3),e.stroke("magenta"),e.fill(e.color(1,0,1,.3)),e.viewFrustum({eMatrix:V??e.createMatrix(4),pMatrix:E??e.createMatrix(4),bits:a.Tree.NEAR|a.Tree.FAR,viewer:()=>e.axes({size:50,bits:a.Tree.X|a.Tree._Y|a.Tree._Z})}),e.pop(),d.begin(),e.clear(),e.background(.7,.4,.3),F(),I.forEach(t=>{k.checked()&&t.animate(),y.checked()?t.cull():t.visibility=a.Tree.VISIBLE,(t.visibility===a.Tree.VISIBLE||t.visibility===a.Tree.SEMIVISIBLE)&&(e.push(),e.translate(t.position),e.noStroke(),e.fill(t.color),t.type==="box"?e.box(t.width,t.height,t.depth):e.sphere(t.radius),e.pop())}),d.end(),e.beginHUD(),e.translate(e.width-e.width/3,e.height),e.scale(1,-1),e.image(d,0,0,e.width/3,e.height/3),e.endHUD()},e.mouseWheel=()=>!1};return R(()=>{f=new a(_,o.value)}),W(()=>{f&&f.remove()}),(e,d)=>(B(),N("div",Y,[x("div",{ref_key:"sketchContainer",ref:o},null,512),d[0]||(d[0]=x("p",{class:"mt-12 text-sm opacity-60 italic"}," Interactive view-frustum manipulation and visibility classification ",-1))]))}},oe={__name:"slides.md__slidev_12",setup(M){const{$clicksContext:o,$frontmatter:f}=L();return o.setup(),(_,e)=>{const d=Z;return B(),D(G,U(X(T($)(T(f),11))),{default:j(()=>[e[0]||(e[0]=x("h1",null,"Visibility visualization",-1)),e[1]||(e[1]=x("p",null,[H("Real-time visibility and frustum culling visualization with "),x("a",{href:"https://www.npmjs.com/package/p5.tree",target:"_blank"},"p5.tree")],-1)),O(d)]),_:1},16)}}};export{oe as default};
